<div class="h-full w-full flex flex-col items-center bg-gray-800 p-4 font-sans text-white select-none">
  <header class="flex-shrink-0 flex items-center justify-between w-full max-w-sm bg-gray-900/50 p-2 rounded-lg mb-4">
    <div class="font-bold text-xl font-mono">{{ mines - flagsPlaced() }} <i class="fas fa-bomb ml-1 text-red-500"></i></div>
    <button (click)="newGame()" class="w-12 h-12 text-2xl bg-gray-700 rounded-lg">
      @switch (gameState()) {
        @case ('playing') { <span>ðŸ™‚</span> }
        @case ('won') { <span>ðŸ˜Ž</span> }
        @case ('lost') { <span>ðŸ˜µ</span> }
      }
    </button>
    <div class="font-bold text-xl font-mono">{{ formatTime(timer()) }} <i class="fas fa-clock ml-1 text-gray-400"></i></div>
  </header>
  
  <main class="flex-grow flex items-center justify-center">
    <div class="grid gap-px bg-gray-700" [style.grid-template-columns]="'repeat(' + cols + ', 1fr)'">
      @for (row of board(); track $index; let r = $index) {
        @for (cell of row; track $index; let c = $index) {
          <div class="cell" 
               (mousedown)="handleCellClick(r, c, $event)"
               (contextmenu)="$event.preventDefault()"
               [class.revealed]="cell.isRevealed"
               [class.flagged]="cell.isFlagged && !cell.isRevealed"
               [class.mine]="cell.hasMine && cell.isRevealed"
               [class.lost]="gameState() === 'lost' && cell.hasMine"
               [class.c1]="cell.adjacentMines === 1"
               [class.c2]="cell.adjacentMines === 2"
               [class.c3]="cell.adjacentMines === 3"
               [class.c4]="cell.adjacentMines === 4"
               [class.c5]="cell.adjacentMines === 5"
               [class.c6]="cell.adjacentMines === 6">
            @if (cell.isRevealed && !cell.hasMine && cell.adjacentMines > 0) {
              {{ cell.adjacentMines }}
            } @else if (cell.isRevealed && cell.hasMine) {
              <i class="fas fa-bomb"></i>
            } @else if (cell.isFlagged && !cell.isRevealed) {
              <i class="fas fa-flag"></i>
            }
          </div>
        }
      }
    </div>
  </main>
</div>
